<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입</title>
    <link rel="stylesheet" href="/css/signup.css">
</head>

<body>

<div class="logo-container">
    <a href="/">
        <img src="/images/logo.jpg" alt="logo">
    </a>
</div>

<!-- 회원가입 성공 메시지 표시 -->
<div th:if="${message}" style="color:green;">
    <p th:text="${message}"></p>
</div>

<!-- 폼에 id="signupForm" 추가 -->
<form id="signupForm" action="/signup" method="post">

    <label for="userId">User ID:</label><br>
    <input type="text" id="userId" name="userId" required><br><br>

    <label for="username">Username:</label><br>
    <input type="text" id="username" name="username" required><br><br>

    <label for="email">Email:</label><br>
    <input type="email" id="email" name="email" required><br><br>

    <label for="password">Password:</label><br>
    <input type="password" id="password" name="password" required><br><br>

    <label for="userPhoneNumber">Phone Number:</label><br>
    <input type="tel" id="userPhoneNumber" name="userPhoneNumber" placeholder="010 1234 5678" pattern="[0-9\s]{11,13}"><br><br>

    <label for="userBirthDate">Birthday:</label><br>
    <input type="date" id="userBirthDate" name="userBirthDate" required><br><br>

    <label>Gender:</label><br>
    <div class="gender">
        <div>
            <label for="male">Male</label>
            <input type="radio" id="male" name="gender" value="male" required>
        </div>
        <div>
            <label for="female">Female</label>
            <input type="radio" id="female" name="gender" value="female" required>
        </div>
    </div>

    <button type="submit">Sign Up</button>
</form>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('signupForm');
        if (form) {
            form.addEventListener('submit', function(event) {
                event.preventDefault();  // 기본 폼 제출 방지

                const formData = new FormData(this);

                // AJAX 요청을 사용하여 서버에 데이터 전송
                fetch('/signup', {
                    method: 'POST',
                    body: new URLSearchParams(formData),
                })
                    .then(response => {
                        // 서버 응답이 성공적이지 않을 경우 경고창 표시
                        if (!response.ok) {
                            return response.text().then(message => {
                                alert(message);  // 경고 메시지 표시
                            });
                        } else {
                            return response.text().then(message => {
                                // 회원가입 성공 시 메인 페이지로 이동
                                alert('회원가입이 완료되었습니다!');
                                window.location.href = '/';
                            });
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            });
        } else {
            console.error('signupForm 요소를 찾을 수 없습니다.');
        }
    });
</script>


</body>
</html>
